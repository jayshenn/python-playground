# Pydantic AI å¯è§‚æµ‹æ€§

> æœ¬æ–‡æ¡£ä»‹ç»å¦‚ä½•ä½¿ç”¨ Pydantic Logfire ç›‘æ§ã€è°ƒè¯•å’Œä¼˜åŒ–ä½ çš„ Agent åº”ç”¨ã€‚

## ğŸ”­ ä¸ºä»€ä¹ˆéœ€è¦å¯è§‚æµ‹æ€§ï¼Ÿ

LLM åº”ç”¨é¢ä¸´çš„æŒ‘æˆ˜ï¼š
- **æ…¢** - å“åº”æ—¶é—´é•¿
- **ä¸å¯é ** - å¯èƒ½å¤±è´¥
- **æ˜‚è´µ** - Token æˆæœ¬é«˜
- **éç¡®å®šæ€§** - è¾“å‡ºä¸ç¨³å®š

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…å’Œé…ç½®

```bash
# Logfire åŒ…å«åœ¨ pydantic-ai ä¸­
pip install pydantic-ai

# è®¤è¯
logfire auth

# åˆ›å»ºé¡¹ç›®
logfire projects new
```

### åŸºç¡€ä½¿ç”¨

```python
import logfire
from pydantic_ai import Agent

# é…ç½® Logfire
logfire.configure()

# å¯ç”¨ instrumentation
logfire.instrument_pydantic_ai()

# æ­£å¸¸ä½¿ç”¨ Agent
agent = Agent('openai:gpt-4')
result = agent.run_sync('ä½ å¥½')

# æ•°æ®è‡ªåŠ¨å‘é€åˆ° Logfire
```

## ğŸ“Š è¿½è¸ªå†…å®¹

è‡ªåŠ¨è¿½è¸ªï¼š
- Agent è¿è¡Œæ—¶é•¿
- Token ä½¿ç”¨é‡
- æˆæœ¬ä¼°ç®—
- å·¥å…·è°ƒç”¨
- HTTP è¯·æ±‚
- é”™è¯¯å’Œå¼‚å¸¸

## ğŸ¯ æœ€ä½³å®è·µ

### 1. ç”Ÿäº§ç¯å¢ƒé…ç½®

```python
import os

if os.getenv('ENVIRONMENT') == 'production':
    logfire.configure(
        # ä¸è®°å½•æ•æ„Ÿå†…å®¹
        include_prompts=False,
        include_completions=False,
        # é‡‡æ ·
        sampling=0.1
    )
```

### 2. è‡ªå®šä¹‰ Spans

```python
@logfire.span('å¤„ç†è®¢å•')
async def process_order(order_id: str):
    logfire.info(f'å¼€å§‹å¤„ç†è®¢å• {order_id}')
    result = await agent.run(f'å¤„ç†è®¢å• {order_id}')
    logfire.info('è®¢å•å¤„ç†å®Œæˆ', order_id=order_id)
    return result
```

### 3. é”™è¯¯è¿½è¸ª

```python
try:
    result = await agent.run(prompt)
except Exception as e:
    logfire.exception('Agent æ‰§è¡Œå¤±è´¥', exc_info=e)
    raise
```

## ğŸ“ˆ ä½¿ç”¨ Logfire å¹³å°

è®¿é—® https://logfire.pydantic.dev æŸ¥çœ‹ï¼š
- Trace è§†å›¾
- æ—¶é—´çº¿åˆ†æ
- æˆæœ¬ç»Ÿè®¡
- æ—¥å¿—æ¶ˆæ¯

## ğŸ”— å‚è€ƒèµ„æº

- [Logfire æ–‡æ¡£](https://docs.pydantic.dev/logfire/)
- [å®˜æ–¹æ–‡æ¡£](https://ai.pydantic.dev/logfire/)
