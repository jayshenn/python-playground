# 高级类型注解

本章节介绍了一些在特定场景下非常有用的高级类型注解工具，这些工具能够提供比基础注解更细粒度的控制和表达力。

## 目录

- [01_class_var.py - ClassVar](01_class_var.py)：介绍如何区分"类变量"和"实例变量"，这对类型检查器非常重要。
- [02_final.py - Final](02_final.py)：介绍如何声明不可变的变量、属性、方法或类，防止意外的重新赋值或重写。
- [03_self_type.py - Self 类型](03_self_type.py)：介绍在类方法中返回当前类实例的简洁方式，特别适用于链式调用和继承。
- [04_annotated.py - Annotated](04_annotated.py)：介绍如何为类型附加任意元数据，这在与 Pydantic 或数据驱动框架集成时非常有用。

## 核心工具

1. **ClassVar**：明确指出某个属性属于类而非具体的实例。
2. **Final**：确保某些配置项、关键方法或整个类不被更改或覆盖。
3. **Self**：Python 3.11+ 引入，解决了以前需要使用字符串或繁琐泛型来表示"返回自身"的问题。
4. **Annotated**：将类型信息与逻辑信息（如验证规则、数据库约束）结合在一起。

## 学习建议

- 始终对类变量使用 `ClassVar`，以避免在实例中意外修改类共享的状态。
- 在编写流畅接口（Fluent Interface）或建造者模式时，务必使用 `Self`。
- 如果你正在开发一个库，`Annotated` 是为用户提供声明式配置的最佳方式。
